---
# - name: Bootstrap GCP
#   hosts: gcp
#   tasks:
#     - include_role:
#         name: bootstrap_add_peers
#       vars:
#         container: "{{item['hostname']}}"
#         node_host_ip: "{{data.node_host_ip}}"
#         node_peer_id: "{{data.node_peer_id}}"
#       with_items: "{{group['gcp']}}"
# loop:
#   - {
#       node_host_ip: "{{hostvars['ipfs1']['ipfs_host']}}",
#       node_peer_id: "{{hostvars['ipfs1']['peer_id']}}",
#     }
#   - {
#       node_host_ip: "{{hostvars['ipfs6']['ipfs_host']}}",
#       node_peer_id: "{{hostvars['ipfs6']['peer_id']}}",
#     }
#   - {
#       node_host_ip: "{{hostvars['ipfs11']['ipfs_host']}}",
#       node_peer_id: "{{hostvars['ipfs11']['peer_id']}}",
#     }
# loop_control:
#   loop_var: data
# ignore_errors: true

- name: Configure Peers
  import_playbook: configure_peers.yaml

- name: Loop over hosts
  hosts: ipfs6
  tasks:
    - name: with with_items
      debug:
        msg: "{{inventory.ansible_host}}"
      with_items: "{{hostvars['ipfs6']}}"

    # - include_role:
    #     name: bootstrap_add_peers
    #   vars:
    #     container: "{{item[hostname]}}"
    #     node_host_ip: "{{ hostvars[item]['peer_id'] }}"
    #     node_peer_id: "{{ hostvars[item]['ipfs_host'] }}"
    #   with_items: "{{ groups['gcp'] }}"
